function selectOptions(){$("#departure-station option:nth-of-type(1)").prop("selected",!0),departureSelect(),$("#arrival-station option:nth-of-type(2)").prop("selected",!0),arrivalSelect()}function departureSelect(){var t=departureDropdown.val();getStops(),getTimes(),arrivalDropdown.children("option").each(function(){this.text===t?$(this).attr("disabled","disabled"):$(this).removeAttr("disabled")})}function arrivalSelect(){var t=arrivalDropdown.val();getStops(),getTimes(),departureDropdown.children("option").each(function(){this.text===t?$(this).attr("disabled","disabled"):$(this).removeAttr("disabled")})}function getStops(){var t=departureDropdown.val(),e=arrivalDropdown.val();$("#stops").html("");var a=stops.indexOf(t),o=stops.indexOf(e);if(o>-1&&a>-1){var r=o>a?"Southbound":"Northbound";if($("#service-direction").html("<h2>"+r+" Service</h2>"),a<o)for(var s=a+1;s<o;s++)$("#stops").append('<p><span class="stop-sign"><i class="fa fa-arrow-down"></i></span>'+stops[s]+"</p>");else for(var i=a-1;i>o;i--)$("#stops").append('<p><span class="stop-sign"><i class="fa fa-arrow-down"></i></span>'+stops[i]+"</p>")}}function getTimes(){var t=departureDropdown.val(),e=arrivalDropdown.val(),a=$(".nav-tabs .active").text(),o=stops.indexOf(t),r=stops.indexOf(e);r>-1&&o>-1&&$.ajax({type:"GET",dataType:"json",url:"https://fleemaja.github.io/data/stop_trips.json",success:function(o){$("#time-table").html("");for(var r,s=o[t],i=o[e],n=0;n<s.length;n++)for(var p=0;p<i.length;p++)s[n].trip_id.toString()===i[p].trip_id.toString()&&s[n].stop_sequence<i[p].stop_sequence&&s[n].trip_day===a&&(r="",r+="<tr>",r+="<td>"+getFormattedTime(s[n].stop_time)+"</td>",r+='<td><i class="fa fa-clock-o" aria-hidden="true"></i> ',r+=getMinutesBetween(s[n].stop_time,i[p].stop_time)+" minutes</td>",r+="<td>"+getFormattedTime(i[p].stop_time)+"</td>",r+="</tr>",$("#time-table").append(r))}})}function getFormattedTime(t){var e=t.split(":"),a=parseInt(e[0],10),o=(a+11)%12+1,r=24!=a&&a>11?"pm":"am",s=e[1];return o+":"+s+" "+r}function getMinutesBetween(t,e){var a=t.split(":"),o=e.split(":"),r=parseInt(a[0]),s=parseInt(o[0]),i=s<r,n=new Date,p=new Date;return n.setHours(r),p.setHours(s),n.setMinutes(a[1]),p.setMinutes(o[1]),i&&p.setDate(parseInt(p.getDate())+1),(p-n)/1e3/60}var departureDropdown=$("#departure-station"),arrivalDropdown=$("#arrival-station"),stops=[];"serviceWorker"in navigator&&navigator.serviceWorker.register("/serviceWorker.js",{scope:"/"}).then(function(t){t.installing?console.log("Service worker installing"):t.waiting?console.log("Service worker waiting"):t.active&&console.log("Service worker active")}).catch(function(t){console.log("Service worker registration failed: "+t)}),$(document).ready(function(){switch($.ajax({type:"GET",dataType:"json",url:"https://fleemaja.github.io/data/stop_list.json",success:function(t){t.forEach(function(t){departureDropdown.append("<option>"+t.stop_name+"</option>"),arrivalDropdown.append("<option>"+t.stop_name+"</option>"),stops.push(t.stop_name)}),selectOptions()}}),(new Date).getDay()){case 0:$("#sunday").addClass("active");break;case 6:$("#saturday").addClass("active");break;default:$("#weekday").addClass("active")}}),departureDropdown.change(function(){departureSelect()}),arrivalDropdown.change(function(){arrivalSelect()}),$(".nav-tabs li").click(function(){$(".nav-tabs li").removeClass("active"),$(this).addClass("active"),getTimes()});